# 常见错误收集

[TOC]

## k8s namespace删除后处于Terminating状态

### 尝试修复步骤：

1. 尝试使用强制删除选项

   ```b
   namespace=cloudon-test
   kubectl delete ns "$namespace" --force --grace-period=0
   ```

   

2. 如果不行，就需要通过kubectl清理数据

   1. 获取当前的namespace数据

      ```bash
      kubectl get ns cloudeon-test -o json >  cloudeon-test.json
      ```

   2. 将namespace的spec内容清空，设置为 `{}`

      ```json
      // ...
      spec: {}
      // ...
      ```

      

   3. 新开一个ssh窗口，使用`kubectl proxy`命令创建代理端口，通过这个端口访问k8s默认只用当前kubectl的用户信息

      ```bash
      kubectl proxy --port=8081
      ```

   4. 使用curl发送清理命令

      ```bash
      namespace=cloudeon-test
      curl -k -H "Content-Type: application/json" -X PUT \
      --data-binary @"$namespace".json  "http://127.0.0.1:8081/api/v1/namespaces/${namespace}/finalize"
      
      ```

      

   5. 

   

3. 

