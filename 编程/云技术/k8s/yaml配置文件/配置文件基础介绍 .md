### 配置文件基础介绍

- 文件结构

- 常见字段

- spec字段常见字段配置

#### 文件结构

##### 文件格式

k8s采用yaml作为配置文件格式，yaml文件只有List和Map两种结构，使用`-`开头表示当前层次为列表，否则当前层次为Map。<br>

###### 多行文本语法

**使用`|`,`|+`,`|-`**: 三种配置都会自动按配置中所写的换行来换行，但是在文末会有一些区别

- `|`：文中自动换行 + 文末新增一空行
- `|+`：文中自动换行 + 文末新增两空行
- `|-`：文中自动换行 + 文末不新增行

例子：

```yaml
string: |
  I am a coder.
  My blog is didispace.com.  
```

结果是：

```
I am a coder.
My blog is didispace.com.
```

###### 单行文本语法

当需要组织超长的单行文本时，可以使用 `>`、`>+`、`>-`来忽略换行

例子：

```yaml
string: >
  I am a coder.
  My blog is didispace.com.
```

结果：

```
I am a coder.My blog is didispace.com.
```

##### 数据结构

k8s的yaml文件的顶层Map有以下字段：

| 字段         | 含义                             |
| ---------- | ------------------------------ |
| apiVersion | 文件的api版本号                      |
| kind       | 资源类型，如Pod，Service等             |
| metadata   | 资源元数据，通常有name、labels和namespace |
| spec       | 资源的描述字段                        |

#### spec常见字段配置

查看字段的配置结构可以通过`kubectl explain`命令，如查看deployment的spec下的template下的spec的containers字段，可以通过命令`kubectl explain deployment.spec.template.spec.containers`

##### selector

labels是定义资源对象的不同功能标签，为了使selector客户端/用户能够识别一组有共同特征或属性的资源对象。不同的资源的selector字段用于筛选不同类型的资源

##### template、containers、initContainers

常用配置字段

- name和

- image和imagePullPolicy

- ports

- readinessProbe、livenessProbe、startupProbe

- args和command

- env和envFrom

- resource、volumnMounts和volumeMounts

- lifecycle

###### image和imagePullPolicy

imagePullPolicy 只有3 种，`Always`标签为latest或者本地不存在从仓库拉取，`IfNotPresent`本地缺失才从仓库拉取，`Never`仅使用本地镜像

###### ports

端口暴露的列表

可配置字段有：

- containerPort（必须）：

- name：自定义名字，用于其他资源引用

- hostIP：绑定到节点的IP

- hostPort：暴露到容器所在host的某个端口上。

###### ReadinessProbe和LivenessProbe

###### env和envFrom

##### resource、volumnMounts和volumeMounts

##### 参考文档

- [K8S Pod配置进阶1 containers字段解释_杨仕虎的博客-CSDN博客](https://blog.csdn.net/yangshihuz/article/details/112599962)
