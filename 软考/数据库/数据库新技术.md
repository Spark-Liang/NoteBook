### NoSQL

优点：并发性能好
缺点：

- 不保证强一致性

#### CAP

- C：一致性（Consistency）
- A：可用性（Availablity）
- P：分区容错性（Partition tolerance）

#### BASE

- BA：基本可用（Basically Available）
- S：软状态（Soft-state）
- E：最终一致性（Eventual consistency）

#### ACID 和 BASE 对比

| ACID       | BASE     |
|:----------:|:--------:|
| 强一致性       | 弱一致性     |
| 隔离性        | 可用性优先    |
| 采用悲观、保守的方法 | 采用乐观的方法  |
| 难以改变       | 适用变化、更简单 |

#### NoSQL查询模型

#### NoSQL 数据库类型

- 文档存储：MongoDB
- 键值存储：Redis，Dynamo，Memcacheed
- 图存储：Neo4j，FlockDB
- 多值数据库：Rocket U2，ESE/NT，OpenInsight，OpenQM
- 列存储：Bigtable，HyperTable，HBase

### 分布式数据库

#### 完全分布式数据库

- 具有分布性
- 逻辑相关性
- 场地透明性
- 场地自治性

#### 特点

- 全局数据的集中控制性
- 数据独立性
  - 逻辑独立性（三层模型逻辑独立性相同）
  - 物理独立性（三层模型物理独立性相同）
  - 位置透明性
- 数据冗余可控性
- 场地自治性
- 存储有效性

#### 四层模式

![](img/四层模式.png)

四层模式的特点

- 全局数据库与局部数据库的分离
- 数据库的数据独立性
- 透明性
- 数据冗余控制

#### 数据分布策略

- 集中式
- 分割式
- 复制式
- 混合式

#### 数据分片

分片方法：

- 水平分片：选择分片
- 垂直分片：投影分片
- 水平和垂直结合的分片

分片原则：

- 完整性原则
- 可重构原则
- 不相交原则

#### 数据分布透明性

- 分片透明
- 分配透明
  - 复制透明
  - 位置透明
- 映像透明性：局部数据模型透明

#### 分布式查询优化

- 考虑通信线路的传输
- 考虑利用多处理器并行处理数据

#### 分布式事务

事务特性：

- 原子性
- 可串行性和一致性
- 隔离性
- 持久性

与集中式事务的区别：

- 执行特性区别：分布式事务需要协调进程协调各个子事务
- 操作特性：分布式事务需要共享控制信息
- 控制报文：分布式事务需要通过报文共享控制信息

##### 事务提交协议

二阶段提交：

1. 表决阶段

2. 执行阶段
   
   二阶段提交规则：
- 只要一个参与者撤销事务，协调者必须做出全局撤销决定
- 只有全部参与者同意提交，协调者才能做出全局提交决定
- 其他情况，比如故障恢复，则需要有协调者做出相应决定
- 三阶段提交
1. 准备提交阶段
2. 全局预提交
3. 全局提交

#### 分布式数据库故障

类型：

- 介质故障
- 系统故障
- 事务故障
- 通信故障
  - 报文故障
  - 网络分隔故障

故障恢复原则：与集中式故障恢复相同

#### 并行数据库体系结构

- 共享内存：共享内存和磁盘
  - 可以基于系统的实际负荷动态给处理器分配任务，较好地实现负载均衡
- 共享磁盘：共享磁盘但各个节点有独立的处理器和内存
  - 成本低，可扩充性好，可用性强
- 无共享：各个节点完全独立
  - 接近线性地扩展系统

### Web 与数据库

#### 三层体系结构

- 客户层
- 服务器层：如：JSP，EJB，Servlet，CGI，ASP，PHP
- 数据层

#### 脚本连接数据库常用方法：ODBC，JDBC，ADO，RDO，DAO

#### B/S 和 C/S

B/S

- 优点：维护成本低

- 缺点：执行效率低
  
  C/S

- 优点：效率高

- 缺点：开发复杂

### XML 与数据库

#### XML 与数据库的数据转换

需要在文档结构和数据库结构进行映射

- 模板驱动
- 模型驱动
  - 表格模型
  - 特点数据对象模型

### 面向对象数据库

#### 特征

- 具有表达和管理对象的能力
- 对象可以具有任意复杂结构
- 必须具有与面向对象编程语言的接口
- 具有表达和管理数据库变化的能力

#### 复杂类型查询语句

例子：
![](img/面向对象查询例子.png)
